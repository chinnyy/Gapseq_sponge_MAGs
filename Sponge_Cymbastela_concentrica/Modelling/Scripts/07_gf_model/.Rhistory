View(full_rxn)
View(medium_list)
medium_list <- read.csv(paste(setwd,gfM_dir,"bin.1-medium_full/bin.1-medium_full.csv",sep = ""), header=TRUE)
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
mod_match <- rbind (mod_match,mod_row)
write.csv(mod_match,paste(out_dir,"/",model_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
View(medium_list)
medium_list <- read.csv(paste(setwd,gfM_dir,"bin.1-medium_full/bin.1-medium_full.csv",sep = ""), header=TRUE)
medium_list$c0_cpd<- paste(medium_list[,1],'[c0]',sep = "")
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
mod_match <- rbind (mod_match,mod_row)
write.csv(mod_match,paste(out_dir,"/",model_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
full_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_full/bin.1-medium_full_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_1_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_1/bin.1-medium_mod_1_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_2_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_2/bin.1-medium_mod_2_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_3_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_3/bin.1-medium_mod_3_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_4_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_4/bin.1-medium_mod_4_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_5_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_5/bin.1-medium_mod_5_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_6_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_6/bin.1-medium_mod_6_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
mod_match <- rbind (mod_match,mod_row)
write.csv(mod_match,paste(out_dir,"/",model_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
# Create empty dataframe to store info
mod_match <- data.frame()
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
mod_match <- rbind (mod_match,mod_row)
write.csv(mod_match,paste(out_dir,"/",model_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
View(mod_match)
View(mod_match)
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
mod_match <- rbind (mod_match,mod_row)
# Rename column
colnames(mod_match)[2:ncol(mod_match)] = c("filtered_full","filtered_1","filtered_2","filtered_3","filtered_4","filtered_5","filtered_6")
write.csv(mod_match,paste(out_dir,"/",model_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
View(mod_match)
# Create empty dataframe to store info
mod_match <- data.frame()
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
mod_match <- rbind (mod_match,mod_row)
# Rename column
colnames(mod_match)[2:ncol(mod_match)] = c("filtered_full","filtered_1","filtered_2","filtered_3","filtered_4","filtered_5","filtered_6")
write.csv(mod_match,paste(out_dir,"/",model_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
ncol(mod_match)
# Create empty dataframe to store info
mod_match <- data.frame()
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
mod_match <- rbind (mod_match,mod_row)
# Rename column
colnames(mod_match)[3:ncol(mod_match)] = c("filtered_full","filtered_1","filtered_2","filtered_3","filtered_4","filtered_5","filtered_6")
write.csv(mod_match,paste(out_dir,"/",model_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
# Create empty dataframe to store info
mod_match <- data.frame()
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
mod_match <- rbind (mod_match,mod_row)
# Rename column
colnames(mod_match) = c("compounds","names","filtered_full","filtered_1","filtered_2","filtered_3","filtered_4","filtered_5","filtered_6")
write.csv(mod_match,paste(out_dir,"/",model_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
# Create empty dataframe to store info
mod_match <- data.frame()
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
mod_match <- rbind (mod_match,mod_row)
# Rename column
colnames(mod_match)[1:ncol(mod_match),] = c("compounds","names","filtered_full","filtered_1","filtered_2","filtered_3","filtered_4","filtered_5","filtered_6")
write.csv(mod_match,paste(out_dir,"/",model_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
# Create empty dataframe to store info
mod_match <- data.frame()
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
mod_match <- rbind (mod_match,mod_row)
# Rename column
colnames(mod_match)[1:ncol(mod_match)] = c("compounds","names","filtered_full","filtered_1","filtered_2","filtered_3","filtered_4","filtered_5","filtered_6")
write.csv(mod_match,paste(out_dir,"/",model_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
# Create empty dataframe to store info
mod_match <- data.frame()
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
# Rename column
colnames(mod_row)[1:ncol(mod_row)] = c("compounds","names","filtered_full","filtered_1","filtered_2","filtered_3","filtered_4","filtered_5","filtered_6")
mod_match <- rbind (mod_match,mod_row)
write.csv(mod_match,paste(out_dir,"/",model_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
View(mod_match)
# Set working directory to where the Bacteria folder is located
setwd= setwd('/Users/chiny/Desktop/UNSW/Gapseq_sponge_MAGs/Sponge_Cymbastela_concentrica/Modelling/Scripts/07_gf_model')
# Import the gap-filled modified object model (gfM):
gfM_dir = '/bin.1/'
bac_id = 'bin.1'
medium_list <- read.csv(paste(setwd,gfM_dir,"bin.1-medium_full/bin.1-medium_full.csv",sep = ""), header=TRUE)
full_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_full/bin.1-medium_full_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_1_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_1/bin.1-medium_mod_1_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_2_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_2/bin.1-medium_mod_2_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_3_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_3/bin.1-medium_mod_3_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_4_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_4/bin.1-medium_mod_4_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_5_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_5/bin.1-medium_mod_5_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_6_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_6/bin.1-medium_mod_6_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
# Create empty dataframe to store info
mod_match <- data.frame()
medium_list$c0_cpd<- paste(medium_list[,1],'[c0]',sep = "")
# Create new folder where the output will be stored
out_dir<- paste(setwd,gfM_dir,"gapfilled_rxn_to_cpd",sep = "")
dir.create(out_dir)
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
# Rename column
colnames(mod_row)[1:ncol(mod_row)] = c("compounds","names","filtered_full","filtered_1","filtered_2","filtered_3","filtered_4","filtered_5","filtered_6")
mod_match <- rbind (mod_match,mod_row)
write.csv(mod_match,paste(out_dir,"/",bac_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
# Rename column
colnames(mod_row)[1:ncol(mod_row)] = c("compounds","names","filtered_full","filtered_1","filtered_2","filtered_3","filtered_4","filtered_5","filtered_6")
mod_match <- rbind (mod_match,mod_row)
write.csv(mod_match,paste(setwd,"/",bac_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
# Rename column
colnames(mod_row)[1:ncol(mod_row)] = c("compounds","names","filtered_full","filtered_1","filtered_2","filtered_3","filtered_4","filtered_5","filtered_6")
mod_match <- rbind (mod_match,mod_row)
write.csv(mod_match,paste(setwd,gfM_dir,bac_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
# Rename column
colnames(mod_row)[1:ncol(mod_row)] = c("compounds","names","filtered_full","filtered_1","filtered_2","filtered_3","filtered_4","filtered_5","filtered_6")
mod_match <- rbind (mod_match,mod_row)
write.csv(mod_match,paste(setwd,gfM_dir,bac_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
View(mod_match)
View(mod_4_rxn)
View(filtered_full)
View(filtered_full)
# Set working directory to where the Bacteria folder is located
setwd= setwd('/Users/chiny/Desktop/UNSW/Gapseq_sponge_MAGs/Sponge_Cymbastela_concentrica/Modelling/Scripts/07_gf_model')
# Import the gap-filled modified object model (gfM):
gfM_dir = '/bin.1/'
bac_id = 'bin.1'
medium_list <- read.csv(paste(setwd,gfM_dir,"bin.1-medium_full/bin.1-medium_full.csv",sep = ""), header=TRUE)
full_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_full/bin.1-medium_full_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_1_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_1/bin.1-medium_mod_1_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_2_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_2/bin.1-medium_mod_2_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_3_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_3/bin.1-medium_mod_3_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_4_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_4/bin.1-medium_mod_4_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_5_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_5/bin.1-medium_mod_5_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_6_rxn <- read.delim(paste(setwd,gfM_dir,"bin.1-medium_mod_6/bin.1-medium_mod_6_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
# Create empty dataframe to store info
mod_match <- data.frame()
medium_list$c0_cpd<- paste(medium_list[,1],'[c0]',sep = "")
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]),toString(filtered_5[,1]),toString(filtered_6[,1]))
# Rename column
colnames(mod_row)[1:ncol(mod_row)] = c("compounds","names","filtered_full","filtered_1","filtered_2","filtered_3","filtered_4","filtered_5","filtered_6")
mod_match <- rbind (mod_match,mod_row)
write.csv(mod_match,paste(setwd,gfM_dir,bac_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
# Set working directory to where the Bacteria folder is located
setwd= setwd('/Users/chiny/Desktop/UNSW/Gapseq_sponge_MAGs/Sponge_Cymbastela_concentrica/Modelling/Scripts/07_gf_model')
# Import the gap-filled modified object model (gfM):
gfM_dir = '/bin.2/'
bac_id = 'bin.2'
medium_list <- read.csv(paste(setwd,gfM_dir,"bin.2-medium_full/bin.2-medium_full.csv",sep = ""), header=TRUE)
full_rxn <- read.delim(paste(setwd,gfM_dir,"bin.2-medium_full/bin.2-medium_full_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_1_rxn <- read.delim(paste(setwd,gfM_dir,"bin.2-medium_mod_1/bin.2-medium_mod_1_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_2_rxn <- read.delim(paste(setwd,gfM_dir,"bin.2-medium_mod_2/bin.2-medium_mod_2_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_3_rxn <- read.delim(paste(setwd,gfM_dir,"bin.2-medium_mod_3/bin.2-medium_mod_3_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_4_rxn <- read.delim(paste(setwd,gfM_dir,"bin.2-medium_mod_4/bin.2-medium_mod_4_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
# Create empty dataframe to store info
mod_match <- data.frame()
medium_list$c0_cpd<- paste(medium_list[,1],'[c0]',sep = "")
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]))
# Rename column
colnames(mod_row)[1:ncol(mod_row)] = c("compounds","names","filtered_full","filtered_1","filtered_2","filtered_3","filtered_4")
mod_match <- rbind (mod_match,mod_row)
write.csv(mod_match,paste(setwd,gfM_dir,bac_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
# Create empty dataframe to store info
mod_match <- data.frame()
medium_list$c0_cpd<- paste(medium_list[,1],'[c0]',sep = "")
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
#  filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
#  filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]))
# Rename column
colnames(mod_row)[1:ncol(mod_row)] = c("compounds","names","filtered_full","filtered_1","filtered_2","filtered_3","filtered_4")
mod_match <- rbind (mod_match,mod_row)
write.csv(mod_match,paste(setwd,gfM_dir,bac_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
# Set working directory to where the Bacteria folder is located
setwd= setwd('/Users/chiny/Desktop/UNSW/Gapseq_sponge_MAGs/Sponge_Cymbastela_concentrica/Modelling/Scripts/07_gf_model')
# Import the gap-filled modified object model (gfM):
gfM_dir = '/bin.2/'
bac_id = 'bin.2'
medium_list <- read.csv(paste(setwd,gfM_dir,"bin.2-medium_full/bin.2-medium_full.csv",sep = ""), header=TRUE)
full_rxn <- read.delim(paste(setwd,gfM_dir,"bin.2-medium_full/bin.2-medium_full_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_1_rxn <- read.delim(paste(setwd,gfM_dir,"bin.2-medium_mod_1/bin.2-medium_mod_1_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_2_rxn <- read.delim(paste(setwd,gfM_dir,"bin.2-medium_mod_2/bin.2-medium_mod_2_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_3_rxn <- read.delim(paste(setwd,gfM_dir,"bin.2-medium_mod_3/bin.2-medium_mod_3_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
mod_4_rxn <- read.delim(paste(setwd,gfM_dir,"bin.2-medium_mod_4/bin.2-medium_mod_4_completely_filled_in_reactions.equation_formatted_n_fluxes.txt",sep = ""))
# Create empty dataframe to store info
mod_match <- data.frame()
medium_list$c0_cpd<- paste(medium_list[,1],'[c0]',sep = "")
# For the compound found in medium_list, find the reaction it is found in and compile it
for (i in 1:nrow(medium_list)){
full_rxn$index <- grepl(medium_list[i,4], full_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_full <- full_rxn[full_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_1_rxn$index <- grepl(medium_list[i,4], mod_1_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_1 <- mod_1_rxn[mod_1_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_2_rxn$index <- grepl(medium_list[i,4], mod_2_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_2 <- mod_2_rxn[mod_2_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_3_rxn$index <- grepl(medium_list[i,4], mod_3_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_3 <- mod_3_rxn[mod_3_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_4_rxn$index <- grepl(medium_list[i,4], mod_4_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
filtered_4 <- mod_4_rxn[mod_4_rxn$index == "TRUE",] # Keep the rows with "TRUE"
#  mod_5_rxn$index <- grepl(medium_list[i,4], mod_5_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
#  filtered_5 <- mod_5_rxn[mod_5_rxn$index == "TRUE",] # Keep the rows with "TRUE"
#  mod_6_rxn$index <- grepl(medium_list[i,4], mod_6_rxn$met_id, fixed=TRUE) # Get the index of reactions with the compounds mentioned
#  filtered_6 <- mod_6_rxn[mod_6_rxn$index == "TRUE",] # Keep the rows with "TRUE"
mod_row <- data.frame(medium_list[i,1:2],toString(filtered_full[,1]),toString(filtered_1[,1]),toString(filtered_2[,1]),toString(filtered_3[,1]),toString(filtered_4[,1]))
# Rename column
colnames(mod_row)[1:ncol(mod_row)] = c("compounds","names","filtered_full","filtered_1","filtered_2","filtered_3","filtered_4")
mod_match <- rbind (mod_match,mod_row)
write.csv(mod_match,paste(setwd,gfM_dir,bac_id,"_gapfilled_rxn_to_cpd.csv",sep = ""), row.names=FALSE)
}
